(()=>{"use strict";var e,n,t;!function(e){e[e.WIDTH=320]="WIDTH",e[e.HEIGHT=200]="HEIGHT"}(e||(e={})),function(e){e[e.WIDTH=4]="WIDTH",e[e.HEIGHT=3]="HEIGHT"}(n||(n={})),function(e){e[e.BLACK=0]="BLACK",e[e.BLUE=1]="BLUE",e[e.GREEN=2]="GREEN",e[e.CYAN=3]="CYAN",e[e.RED=4]="RED",e[e.MAGENTA=5]="MAGENTA",e[e.BROWN=6]="BROWN",e[e.LIGHT_GRAY=7]="LIGHT_GRAY",e[e.GRAY=8]="GRAY",e[e.LIGHT_BLUE=9]="LIGHT_BLUE",e[e.LIGHT_GREEN=10]="LIGHT_GREEN",e[e.LIGHT_CYAN=11]="LIGHT_CYAN",e[e.LIGHT_RED=12]="LIGHT_RED",e[e.LIGHT_MAGENTA=13]="LIGHT_MAGENTA",e[e.YELLOW=14]="YELLOW",e[e.WHITE=15]="WHITE"}(t||(t={}));const a=[0,170,43520,43690,11141120,11141290,11162880,11184810,5592405,5592575,5635925,5636095,16733525,16733695,16777045,16777215],r=new Array(a.length).fill(null).map(((e,n)=>{return t=a[n],new Uint8ClampedArray([t>>>16,255&t>>>8,255&t,255]);var t})),o=new Array(e.WIDTH*e.HEIGHT).fill(t.BLACK);let i=0,l=0;var c;!function(e){e[e.STRING=0]="STRING",e[e.NUMBER=1]="NUMBER"}(c||(c={}));class s{type;value;index;constructor(e,n,t){this.type=e,this.value=e===c.NUMBER?parseInt(n):n,this.index=t}}function d(n,t,a){n>=0&&t>=0&&n<e.WIDTH&&t<e.HEIGHT&&(o[e.WIDTH*t+n]=a)}function E(e,n,t,a,r){let o,c,s,E,u;void 0===a||void 0===r?(o=i,c=l,s=e,E=n,u=t):(o=e,c=n,s=t,E=a,u=r),i=s,l=E;const H=Math.abs(s-o),h=o<s?1:-1,I=-Math.abs(E-c),T=c<E?1:-1;let w=H+I;for(;d(o,c,u),o!==s||c!==E;){const e=2*w;if(e>=I){if(o===s)break;w+=I,o+=h}if(e<=H){if(c===E)break;w+=H,c+=T}}}let u,H;async function h(){document.getElementById("main-content").innerHTML=`<canvas id="lunar-canvas" class="canvas" width="${e.WIDTH}" \n            height="${e.HEIGHT}"></canvas>`,u=document.getElementById("lunar-canvas"),u&&(I(),o.fill(t.BLACK),function(e){const n=function(e){e=e.toUpperCase();let n=[],t=null,a="",r=0;for(let o=0;o<=e.length;++o){const i=o<e.length?e.charAt(o):"\0";i>="A"&&i<="Z"?(t!==c.STRING&&(null!==t&&n.push(new s(t,a,r)),t=c.STRING,a="",r=o),a+=i):i>="0"&&i<="9"?(t!==c.NUMBER&&(null!==t&&n.push(new s(t,a,r)),t=c.NUMBER,a="",r=o),a+=i):(null!==t&&n.push(new s(t,a,r)),t=null,a="")}return n}(e);let t=0,a=0,r=0,o=0;for(;r<n.length;){const e=n[r++];if(e.type!==c.STRING)throw new Error(`<${e.index}> Expected string: ${e.value}`);const i=e.value;let l,s;if(i.length>2)throw new Error(`<${e.index}> String too long: ${e.value}`);if(2===i.length?(l=i.charAt(0),s=i.charAt(1)):(l=null,s=i.charAt(0)),r>=n.length)throw new Error("Expected number, but reached end of string.");const d=n[r++];if(d.type!==c.NUMBER)throw new Error(`<${d.index}> Expected number: ${d.value}`);const u=d.value;let H=t,h=a;switch(s){case"C":o=u;continue;case"U":h-=u;break;case"D":h+=u;break;case"L":H-=u;break;case"R":H+=u;break;case"E":H+=u,h-=u;break;case"F":H+=u,h+=u;break;case"G":H-=u,h+=u;break;case"H":H-=u,h-=u;break;case"M":{if(r>=n.length)throw new Error("Expected number, but reached end of string.");const e=n[r++];if(e.type!==c.NUMBER)throw new Error(`<${e.index}> Expected number: ${e.value}`);H=u,h=e.value;break}default:throw new Error(`<${e.index}> Unknown command: ${s}`)}if(null===l)E(t,a,H,h,o),t=H,a=h;else if("B"===l)t=H,a=h;else{if("N"!==l)throw new Error(`<${e.index}> Invalid prefix: ${e.value}`);E(t,a,H,h,o)}}}("BM0,6C12R16L1H1L12D2C4R12L1G1L8BL1BU4C11R10H1L8U1R8H1L6R1E1R2D1C15R1D1R1D1BD1BL3C3L3U1F1U1E1"),H.drawImage(await async function(){const n=new Uint8ClampedArray(e.WIDTH*e.HEIGHT*4);for(let e=o.length-1,t=n.length-4;e>=0;--e,t-=4)n.set(r[o[e]],t);return async function(e,n,t){return new Promise(((a,r)=>{const o=document.createElement("canvas");o.width=n,o.height=t;const i=o.getContext("2d");if(null===i)throw new Error("Failed to create 2d context.");const l=new ImageData(e,n,t);i.putImageData(l,0,0);const c=new Image;c.onload=()=>a(c),c.onerror=e=>r(new Error("Failed to load the image")),c.src=o.toDataURL()}))}(n,e.WIDTH,e.HEIGHT)}(),0,0))}function I(){if(H=null,u=document.getElementById("lunar-canvas"),!u)return;u.style.display="none";const t=window.innerWidth,a=window.innerHeight;let r,o;const i=new DOMMatrix;t>=a?(u.width=e.WIDTH,u.height=e.HEIGHT,r=t,o=r*n.HEIGHT/n.WIDTH,a<o&&(o=a,r=o*n.WIDTH/n.HEIGHT)):(u.width=e.HEIGHT,u.height=e.WIDTH,o=a,r=o*n.HEIGHT/n.WIDTH,t<r&&(r=t,o=r*n.WIDTH/n.HEIGHT),i.a=i.d=i.e=0,i.b=-1,i.c=1,i.f=e.WIDTH),u.style.display="block",u.style.width=`${Math.floor(r)}px`,u.style.height=`${Math.floor(o)}px`,u.style.left=`${Math.floor((t-r)/2)}px`,u.style.top=`${Math.floor((a-o)/2)}px`,H=u.getContext("2d"),H&&(H.setTransform(i),H||I())}let T=null,w=!1,f=null;const L=()=>{null!=f&&f();const e=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`);e.addEventListener("change",L),f=()=>e.removeEventListener("change",L),I()};document.addEventListener("DOMContentLoaded",(function(){document.addEventListener("dblclick",(e=>e.preventDefault()),{passive:!1}),window.addEventListener("touchmove",(e=>e.preventDefault()),{passive:!1}),document.addEventListener("visibilitychange",(()=>{"visible"===document.visibilityState&&!w&&null===T&&"wakeLock"in navigator&&(w=!0,navigator.wakeLock.request("screen").then((e=>{w&&(T=e,T.addEventListener("release",(()=>{w||(T=null)})))})).catch((e=>{})).finally((()=>w=!1)))})),window.addEventListener("resize",I),h(),L()}))})();